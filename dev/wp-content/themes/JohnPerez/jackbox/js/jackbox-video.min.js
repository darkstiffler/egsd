(function(a){function la(){da.attr({width:j.width(),height:j.height()})}function ma(){ea=j.width();x=ea-237+J;K&&(n.css("width",x),C.css("width",x),U());g.width(ea);g.height(j.height())}function na(c){g=a("<video />").addClass("cj-video");b=g[0];a("<source />").attr("type","video/webm").attr("src",c+".webm").prependTo(g);a("<source />").attr("type","video/mp4").attr("src",c+".mp4").prependTo(g)}function V(a,b){0!==a?(b&&(s.show(),t.hide()),s.hide(),t.show(),u.data("isOn",!0)):(b&&(t.show(),s.hide()), t.hide(),s.show(),u.data("isOn",!1),D&&k.css("width",0))}function oa(c){c&&c.stopPropagation();b.removeEventListener("canplay",oa,!1);b.pause();E=a(".cj-vid-full");p=a(".cj-vid-play");l=a(".cj-vid-pause");s=a(".cj-vid-mute");C=a(".cj-vid-total");F=a(".cj-vid-normal");t=a(".cj-vid-volume");n=a(".cj-vid-lines");G=a(".cj-vid-time");y=a(".cj-vid-progress");L=a(".cj-vid-vol-total");k=a(".cj-vid-vol-current");u=a(".cj-vid-vol-buttons");z=a(".cj-vid-vol-lines");M=a(".cj-vid-fullscreen");N=a(".cj-vid-play-pause"); q=a("<span />").addClass("cj-vid-play-btn").appendTo(h);H=N.length&&p.length&&l.length;fa=u.length&&t.length&&s.length;D=z.length&&k.length&&L.length;pa=M.length&&E.length&&F.length;K=n.length&&y.length&&C.length;O=G.length;H?(W?(p.hide(),l.show()):(l.hide(),p.show()),N.click(X)):N.length?N.hide():(p.length&&p.hide(),l.length&&l.hide());fa?(V(r,!0),u.click(Aa)):u.length?u.hide():(t.length&&t.hide(),s.length&&s.hide());D?(qa=parseInt(z.css("padding-left"),10)||9,ga=parseInt(L.css("width"),10)||55, k.css("width",ga*r),z.click(Ba)):(D=!1,z.length?z.hide():(k.length&&k.hide(),L.length&&L.hide()));pa&&("webkitSupportsFullscreen"in b||"mozFullScreenEnabled"in d)?(M.click(Ca),P=!1,J=0):(J=22,M.length?M.hide():(E.length&&E.hide(),F.length&&F.hide()));K?(n.css("width",x+J),C.css("width",x+J),y.css("width",0),n.click(Da)):n.length?n.hide():(y.length&&y.hide(),C.length&&C.hide());O&&(e=b.duration/60,v=parseInt(60*(e-parseInt(e,10)),10),e=parseInt(e,10),Q="/"+(10>e?"0"+e:e)+":"+(10>v?"0"+v:v),G.text("00:00"+ Q));R=!1;b.addEventListener("ended",Ea,!1);w.mouseenter(Fa).mouseleave(Ga);g.click(X);q.click(X);I=!1;b.pause();b.volume=r;parent.hasOwnProperty("jackboxFrameReady")?(Y=!0,parent.jackboxFrameReady()):a.jackboxVideo.fullyLoaded()}function Ha(){b.play()}function ra(){I=!0;null!==f&&clearTimeout(f);f=setTimeout(S,3E3);h.mousemove(Z).mouseleave(S)}function Fa(){R=!0}function Ga(){R=!1}function Z(a){a&&a.stopPropagation();null!==f&&clearTimeout(f);A?w.css("opacity",1):w.animate({opacity:1},300);if(B&& !R&&I&&(!P||ha))f=setTimeout(S,3E3)}function S(){null!==f&&clearTimeout(f);A?w.css("opacity",0):w.animate({opacity:0},300)}function Ea(a){a.stopPropagation();null!==i&&(clearInterval(i),i=null);null!==f&&(clearTimeout(f),f=null);null!==m&&(clearTimeout(m),m=null);b.pause();I=!1;b.currentTime=0;G.text("00:00"+Q);h.unbind("mousemove",Z).unbind("mouseleave",S);K&&y.css("width",0);H&&(l.hide(),p.show());A?(w.css("opacity",1),q.css({cursor:"pointer",opacity:1})):(w.animate({opacity:1},300),q.css("cursor", "pointer").animate({opacity:1},300))}function X(){b.paused?(b.play(),H&&(p.hide(),l.show()),I||ra(),K&&(i=setInterval(U,250)),A?q.css({cursor:"auto",opacity:0}):q.css("cursor","auto").animate({opacity:0},300)):(b.pause(),H&&(l.hide(),p.show()),null!==i&&(clearInterval(i),i=null),A?q.css({cursor:"pointer",opacity:1}):q.css("cursor","pointer").animate({opacity:1},300));Z()}function Ba(a){a.stopPropagation();var a=a.pageX-z.offset().left-qa,d=a/ga;k.css("width",a);b.volume=d;fa&&V(d,!1)}function Aa(){u.data("isOn")? (D&&(sa=parseInt(k.css("width"),10),k.css("width",0)),ia=b.volume,b.volume=0,V(0,!1)):(D&&k.css("width",sa),b.volume=ia,V(1,!1))}function Da(a){a.stopPropagation();null!==i&&(clearInterval(i),i=null);null===ja&&(ja=parseInt(n.css("padding-left"),10));b.pause();b.currentTime=b.duration*((a.pageX-n.offset().left-ja)/x);U();X()}function U(){ta=b.currentTime/b.duration;y.css("width",x*ta|0);O&&(e=b.currentTime/60,v=parseInt(60*(e-parseInt(e,10)),10),e=parseInt(e,10),G.text((10>e?"0"+e:e)+":"+(10>v?"0"+ v:v)+Q))}function Ia(){P=!1;m=null}function Ca(){B?aa():d.mozFullScreenEnabled?(d.addEventListener("mozfullscreenchange",ua,!1),h[0].mozRequestFullScreen()):b.webkitSupportsFullscreen&&(null!==m&&clearTimeout(m),P=!0,m=setTimeout(Ia,4E3),d.addEventListener("webkitfullscreenchange",ba,!1),h[0].webkitRequestFullScreen());B=!B}function ua(){d.mozFullScreen?(B=!0,va()):aa(!0)}function ba(){d.webkitIsFullScreen?(d.removeEventListener("webkitfullscreenchange",ba,!1),B=!0,setTimeout(va,50)):aa(!0)}function va(){E.hide(); F.show();Z();R=!1;j.off("resize.cj").on("resize.cj",Ja);b.webkitSupportsFullscreen&&d.addEventListener("webkitfullscreenchange",ba,!1)}function Ja(){j.off("resize.cj");aa()}function aa(a){if(d.mozFullScreenEnabled){d.removeEventListener("mozfullscreenchange",ua,!1);if(a)return;d.mozCancelFullScreen()}else b.webkitSupportsFullscreen&&(d.removeEventListener("webkitfullscreenchange",ba,!1),null!==m&&(clearTimeout(m),P=!1,m=null),a||d.webkitCancelFullScreen());E.show();F.hide();B=!1;I&&S()}var r=75,ja= null,da=null,B=!1,m=null,f=null,i=null,ha=!1,H,D,I,P,G,R,A,h,Q,fa,N,qa,sa,ia,O,ka,J,w,n,y,z,M,L,ga,ea,K,Y,wa,g,q,pa,s,t,T,xa,x,ya,C,k,u,F,za,b,ta,l,W,e,v,p,E,j,ca,d;a.jackboxVideo=function(){"undefined"!==typeof Modernizr?(T=Modernizr.touch,ka=Modernizr.video,A=Modernizr.csstransitions):ka=T=A=!1;d=document;j=a(window);a(d);ya=a("body");h=a("<div />").addClass("cj-video-container").appendTo(ya);r*=0.01;ha=a.browser.mozilla;za=a.browser.msie&&9>a.browser.version;var c=d.URL.split("?")[1],e=c.indexOf("poster="), f=c.substring(e+7,c.length);W=-1!==c.search("autoplay=true")?!T?!0:!1:!1;ca=c.substring(c.indexOf("video=")+6,c.indexOf("&autoplay")).split(".mp4")[0];ka&&"false"===c.substring(c.indexOf("flashing=")+9,c.indexOf("&width"))&&!za?(na(ca),T?("false"!==f&&g.attr("poster",f),g.attr("controls","controls").prependTo(h),parent.hasOwnProperty("jackboxFrameReady")?(Y=!0,parent.jackboxFrameReady()):a.jackboxVideo.fullyLoaded()):(w=a("<div />").addClass("cj-vid-controls").html('<div class="cj-vid-play-pause"><span class="cj-vid-play"></span><span class="cj-vid-pause"></span></div><div class="cj-vid-time">00:00/00:00</div><div class="cj-vid-lines"><span class="cj-vid-total"></span><span class="cj-vid-progress"></span></div><div class="cj-vid-vol-buttons"><span class="cj-vid-volume"></span><span class="cj-vid-mute"></span></div><div class="cj-vid-vol-lines"><span class="cj-vid-vol-total"></span><span class="cj-vid-vol-current"></span></div><div class="cj-vid-fullscreen"><span class="cj-vid-full"></span><span class="cj-vid-normal"></span></div>').appendTo(h), g.prependTo(h),b.volume=0,0===r&&(r=1),ia=r,b.addEventListener("canplay",oa,!1),b.play())):T?(na(ca),"false"!==f&&g.attr("poster",f),g.attr("controls","controls").prependTo(h),parent.hasOwnProperty("jackboxFrameReady")?(Y=!0,parent.jackboxFrameReady()):a.jackboxVideo.fullyLoaded()):(f=c.indexOf("height="),xa=c.substring(c.indexOf("width=")+6,f),wa=c.substring(f+7,e),"jackboxFrameReady"in parent?parent.jackboxFrameReady(!0):a.jackboxVideo.fullyLoaded())};a.jackboxVideo.videoReady=function(){la();j.resize(la); try{(!a.browser.msie?d.myflash:j[0].myflash).videoResized()}catch(b){}h.css("background-image","none");g.css("opacity",1)};a.jackboxVideo.fullyLoaded=function(){g?(ma(),j.resize(ma),h.css("background-image","none"),g.css("visibility","visible"),O&&G.text("00:00"+Q),Y&&ha&&h.addClass("cj-video-fix"),W&&(setTimeout(Ha,100),O&&(i=setInterval(U,250)),ra(),q.css({cursor:"auto",opacity:0}),H&&l.show())):(da=a('<object id="myflash" type="application/x-shockwave-flash" data="../swf/video_fallback.swf" width="640" height="360"><param name="movie" value="../swf/video_fallback.swf" /><param name="allowScriptAccess" value="always" /><param name="bgcolor" value="#000000" /><param name="allowfullscreen" value="true" /><param name="wmode" value="transparent" /><param name="flashvars" value="url='+ ca+".mp4&vol="+r+"&auto="+W+"&width="+xa+"&height="+wa+'" /></object>'),g=a("<div />").css("opacity",0).prependTo(h).append(da))};a(document).ready(function(){a.jackboxVideo()})})(jQuery);function videoReady(){$.jackboxVideo.videoReady()}function cjInit(){$.jackboxVideo.fullyLoaded()};