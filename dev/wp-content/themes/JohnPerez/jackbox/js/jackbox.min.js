(function(c){function ob(){A=c(window);ac=c("body");pb=c("body, html");n=c("<div />").addClass("jackbox-modal");j=c("<div />").addClass("jackbox-holder");aa=c("<div />").addClass("jackbox-wrapper");P=c("<div />").addClass("jackbox-preloader");ba=c("<span />").addClass("jackbox-panel jackbox-panel-left");la=c("<span />").addClass("jackbox-panel jackbox-panel-right");var a=l.createDocumentFragment();a.appendChild(aa[0]);a.appendChild(P[0]);n[0].appendChild(a);a=l.createDocumentFragment();a.appendChild(ba[0]); a.appendChild(la[0]);a.appendChild(j[0]);aa[0].appendChild(a);ca=c("<div />").addClass("jackbox-container");ma||(Fa=c("<span />").addClass("jackbox-pre-inside").appendTo(P));na*=2;Ua=0;a=l.createDocumentFragment();qb&&(v=c(qb).hide(),a.appendChild(v[0]));a.appendChild(ca[0]);rb&&(w=c(rb).hide(),a.appendChild(w[0]));j[0].appendChild(a);sb=-(G+ya);oa=[];Ga=[];C=[];D=[];tb.each(bd);M&&(c.address.internalChange(ub),c.address.externalChange(cd));bc=!0;Ha&&(M?setTimeout(Ha,250):Ha(),Ha=null);tb=Ga=qb=rb= oa=null}function bd(){var a=c(this).attr("data-group").split(" ").join("").toLowerCase();if(ma){for(var b=D.length,d=!1;b--;)if(D[b]===a){d=!0;break}d||cc(a)}else-1===D.indexOf(a)&&cc(a)}function cc(a){D[D.length]=a;Ga=[];c(".jackbox[data-group="+a+"]").each(dc);C[C.length]=Ga;Va++}function dc(a){isNaN(a)?e=a:(e=c(this).data({id:a,cat:Va}),Ga[a]=e);if(h=e.attr("href")||e.attr("data-href")){var b,a="#"!==h.charAt(0)?h.toLowerCase().split(".").pop():"inline";if(b=-1!==h.search("youtube.com")?"youtube": -1!==h.search("vimeo.com")?"vimeo":"mp4"===a?"local":!1){if(e.data("type",b),!e.attr("data-thumbnail"))if("vimeo"===b){var d=e;c.getJSON("http://vimeo.com/api/v2/video/"+h.split("http://vimeo.com/")[1]+".json?callback=?",{format:"json"},function(a){d.attr("data-thumbnail",a[0].thumbnail_small)})}else"youtube"===b&&e.attr("data-thumbnail","http://img.youtube.com/vi/"+h.split("http://www.youtube.com/watch?v=")[1]+"/1.jpg")}else if("jpg"===a||"png"===a||"jpeg"===a||"gif"===a)e.data("type","image");else switch(a){case "mp3":e.data("type", "audio");break;case "swf":e.data("type","swf");break;case "inline":e.data("type","inline");break;default:e.data("type","iframe")}e.on("click.jackbox",dd);if(H=e.attr("data-description")){if(oa)if(a=oa.indexOf(H),-1===a){H=c(H);if(!H.length)return;oa[oa.length]=H}else H=oa[a];else if(H=c(H),!H.length)return;e.data("description",H)}}}function cd(a){if(fc){fc=!1;var b=l.URL.split("?url=");if(2===b.length){window.location=b[0]+"#/"+b[1];return}}clearTimeout(Ia);gc(a.value);-1!==y?hc?(hc=!1,ub()):Ia=setTimeout(ub, 750):Q&&vb()}function ub(a){"object"===typeof a&&(clearTimeout(Ia),gc(a.value));-1!==y?ic():Q&&vb()}function gc(a){E&&(!da&&!za)&&p[f].removeClass("jb-thumb-active");"/"!==a?(a=a.split("/"),3===a.length?(f=parseInt(a[2],10)-1,isNaN(f)&&(f=0),ea=a[1]):isNaN(a[1])?(f=0,ea=a[1]):(f=parseInt(a[1],10)-1,ea="/")):(ea="/",f=0);if("/"!==ea)for(a=Va;a--;){if(D[a]===ea){y=a;I=C[y].length;N=1!==I;break}}else y=-1;za=!1}function Wa(){clearTimeout(jc);jc=setTimeout(fa,100)}function dd(a){a.stopPropagation();a.preventDefault(); a=c(this).data();Xa(a.cat,a.id,!0)}function Xa(a,b,d){clearTimeout(Ia);if(!d){if(E)for(d=p.length;d--;)p[d].off("click.jackbox");ba.off(".jackbox");la.off(".jackbox");s&&wb&&i.cjSwipe("unbindSwipe")}M?c.address.value(D[a]+"/"+(b+1)):(E&&(!da&&!za)&&p[f].removeClass("jb-thumb-active"),f=b,y=a,I=C[y].length,N=1!==I,ic())}function xb(a){if(a&&(a.stopPropagation(),Ja))return!1;Q&&(E&&!da&&p[f].removeClass("jb-thumb-active"),f<C[y].length-1?f++:f=0,za=!0,Xa(y,f))}function yb(a){if(a&&(a.stopPropagation(), Ja))return!1;Q&&(E&&!da&&p[f].removeClass("jb-thumb-active"),0<f?f--:f=C[y].length-1,za=!0,Xa(y,f))}function kc(){for(var a=[n[0],aa[0],j[0],ca[0]],b=4;b--;)a[b].removeEventListener("touchstart",z,!1),a[b].removeEventListener("touchmove",z,!1),a[b].removeEventListener("touchend",z,!1)}function ic(){Ya=C[y];if(e=Ya[f]){if(s)for(var a=[n[0],aa[0],j[0],ca[0]],b=4;b--;)a[b].addEventListener("touchstart",z,!1),a[b].addEventListener("touchmove",z,!1),a[b].addEventListener("touchend",z,!1);h=e.attr("href")|| e.attr("data-href");Q?(Ja=!0,lc(),mc()):(Q=!0,s?l.addEventListener("touchmove",z,!1):(pb.stop(),Ua=A.scrollTop()),n.appendTo(ac).one("click.jackbox",nc),oc=n.parents().each(ed),pc||(pc=!0,zb=parseInt(j.css("padding-left"),10)+parseInt(j.css("padding-right"),10),Ka=parseInt(j.css("padding-top"),10)+parseInt(j.css("padding-bottom"),10),qc=parseInt(ba.css("width"),10)+14,Za=Ka+na,Ab=G+(ya<<1),$a=parseInt(P.css("margin-top"),10),rc=$a-(Ab>>1),sc=parseInt(j.css("padding-left"),10),tc=parseInt(j.css("padding-top"), 10),J=c(".jackbox-fullscreen"),J.length||(J=null),pa=!s&&"safari"!==ab&&("webkitRequestFullScreen"in n[0]||"mozFullScreenEnabled"in l)),ga=!Bb&&bb&&N?0:sb,B=A.width(),K=A.height(),j.css({width:B,height:K,marginLeft:-(B>>1)-sc,marginTop:-(K>>1)-tc}),Jacked.fadeIn(n[0],{callback:fd}),uc=setTimeout(mc,250),aa.on("click.jackbox",vc))}}function ed(){c(this).addClass("jackbox-overflow")}function gd(){c(this).removeClass("jackbox-overflow")}function fd(){A[0].scrollTo(0,0)}function mc(){!Cb&&Fa&&(Fa.addClass("jackbox-pre-ready"), Cb=!0);E&&(p[f].addClass("jb-thumb-active"),da?da=!1:Db(!1,!0));var a=e.attr("data-autoplay")?e.attr("data-autoplay"):wc,b=e.data("description")||null,d=e.attr("data-title")||"",ec;cb="true"===e.attr("data-scaleUp");db=b?b.html():!1;R=e.data("type");d?(Eb=d,ha=escape(Eb)):(ha=!1,"undefined"!==typeof x&&(x.data("links")&&x.data("links").off(".jackbox"),x.empty()));s&&(wb="image"===R||"inline"===R);"image"!==R&&xc();568<B?P.css("margin-top",0===ga?rc:$a):P.css("margin-top",$a);aa.show();P.addClass("jackbox-spin-preloader"); switch(R){case "image":La=!0;i=c("<img />").addClass("jackbox-content").one("load.jackbox",Ma).prependTo(ca);s&&(i[0].addEventListener("touchstart",z,!1),i[0].addEventListener("touchmove",z,!1),i[0].addEventListener("touchend",z,!1));i.attr("src",h);break;case "youtube":qa(hd.split("{url}").join(h.split("watch?v=")[1]).split("{autoplay}").join("true"===a?1:0));break;case "vimeo":qa(id.split("{url}").join(h.substring(h.lastIndexOf("/"))).split("{autoplay}").join(a));break;case "local":b=Fb();d=e.attr("data-flashHasPriority")? e.attr("data-flashHasPriority"):yc.toString();ec="false"===d&&pa&&"firefox"!==ab;b=e.attr("data-poster")?b+e.attr("data-poster"):"false";qa(jd+"?video="+h+"&autoplay="+a+"&flashing="+d+"&width="+S+"&height="+T+"&poster="+b,!0);break;case "audio":Fb();qa(kd+"?audio="+h+"&title="+(e.attr("data-audiotitle")?e.attr("data-audiotitle"):ha)+"&autoplay="+a);break;case "swf":Fb();qa(ld+"?swf="+h+"&width="+(k.toString()+"&height="+g.toString()));break;case "inline":a=c(h);i=c("<div />").addClass("jackbox-content jackbox-html").html(a.length? a.html():"").prependTo(ca);i.css("width",k);e.attr("data-height",i.outerHeight(!0));xc();Ma();break;default:qa(h,!1,!0)}pa&&(!ec?J.show():J.hide())}function Fb(){if(-1===h.search("http")){var a=l.URL.split("#")[0];"/"!==a[a.length-1]&&(a=a.substring(0,a.lastIndexOf("/")+1));h=a+h;return a}}function md(){ia.css("visibility","hidden")}function nd(){m.data("offLeft",m.offset().left)}function zc(){Aa.css({opacity:0,visibility:"hidden"})}function Ac(a){"object"===typeof a&&a.stopPropagation();q<I-ja&& (q++,eb(!1,!0))}function Bc(a){"object"===typeof a&&a.stopPropagation();0<q&&(q--,eb(!1,!0))}function od(a){a.stopPropagation();a=c(this).parent();a.addClass("jb-thumb-fadein");s||a.addClass("jb-thumb-hover");a.data("id")===f&&a.addClass("jb-thumb-active")}function Cc(a){a.stopPropagation();if(Ja)return!1;a=c(this).data("id");a!==f&&(E&&p[f].removeClass("jb-thumb-active"),f=a,da=!0,Xa(y,f))}function pd(){Na?Dc():(A.off(".jackbox"),Na=!0,l.mozFullScreenEnabled?(l.addEventListener("mozfullscreenchange", fb,!1),n[0].mozRequestFullScreen()):n[0].webkitRequestFullScreen&&(l.addEventListener("webkitfullscreenchange",fb,!1),n[0].webkitRequestFullScreen()))}function fb(){l.webkitIsFullScreen||l.mozFullScreen?fa():Dc(!0)}function Gb(a){l.removeEventListener(a.type,Gb,!1);fa();A.on("resize.jackbox",Wa)}function Dc(a){Na=!1;l.mozFullScreenEnabled?(l.removeEventListener("mozfullscreenchange",fb,!1),a?(fa(),A.on("resize.jackbox",Wa)):(l.addEventListener("mozfullscreenchange",Gb,!1),l.mozCancelFullScreen())): n[0].webkitRequestFullScreen&&(l.removeEventListener("webkitfullscreenchange",fb,!1),a?(fa(),A.on("resize.jackbox",Wa)):(l.addEventListener("webkitfullscreenchange",Gb,!1),l.webkitCancelFullScreen()))}function xc(){La=!1;S=e.attr("data-width")?parseInt(e.attr("data-width"),10):Ec;T=e.attr("data-height")?parseInt(e.attr("data-height"),10):Fc;cb="true"===e.attr("data-scaleUp");Gc()}function Gc(){gb=S+zb+qc+na;Hb=T+Za;fa("true")}function lc(){clearTimeout(uc);Jacked.stopTween(j[0]);A.off(".jackbox"); i&&(Jacked.stopTween(i[0]),i.remove(),i=null);hb&&(hb.remove(),hb=null);v&&(Jacked.stopTween(v[0],!0),v.hide());w&&(Jacked.stopTween(w[0],!0),w.hide());r&&(r.removeClass("jb-info-inactive"),Jacked.stopTween(F[0]),F.empty().hide())}function nc(a){a.stopPropagation();M?c.address.value(""):vb()}function vb(){clearTimeout(Ia);lc();n.unbind(".jackbox");if(N){ra&&ra.off(".jackbox");sa&&sa.off(".jackbox");Oa&&m&&m.off(".jackbox");Jacked.stopTween(la[0],!0);Jacked.stopTween(ba[0],!0);var a={opacity:0,visibility:"hidden"}; la.off(".jackbox").css(a);ba.off(".jackbox").css(a)}else ta&&ta.show(),t&&t.show();aa.hide().off(".jackbox");P.removeClass("jackbox-spin-preloader");"undefined"!==typeof x&&(x.data("links")&&x.data("links").off(".jackbox"),x.empty());pa&&J.off(".jackbox");ua&&ua.unbind(".jackbox");r&&r.off(".jackbox");if(E){Jacked.stopTween(U[0]);for(U.off(".jackbox").hide();p.length;)a=p[0],Jacked.stopTween(a[0]),a.remove(),p.shift();V.off(".jackbox").hide();W.off(".jackbox").hide();s&&m.cjSwipe("unbindSwipe");Jacked.stopTween(L[0]); L.empty().css("margin-left",0);t&&(t.off(".jackbox"),t&&(O.hide(),X.show()));E=p=null}oc.each(gd);Jacked.fadeOut(n[0],{duration:1E3,callback:qd});j.css({marginLeft:rd,marginTop:sd});s?(kc(),l.removeEventListener("touchmove",z,!1)):setTimeout(td,10);ia&&ia.css("visibility","hidden");Fa&&Fa.removeClass("jackbox-pre-ready");e=Q=Na=da=Ib=ib=za=Jb=Ba=Cb=null}function td(){0!==Ua&&pb.animate({scrollTop:Ua},{duration:300,queue:!1})}function qd(){n.detach()}function ud(a){!a?xb():yb()}function z(a){a.preventDefault()} function vd(a,b){if(!Q&&"success"===b.toLowerCase()&&a){var d=a.length,e=document.URL;for(e.substring(0,e.lastIndexOf("/"));d--;)c("<img />").attr("src",Hc+"/"+a[d].split("../").join(""))}}function wd(){var a=c(this),b=a.next("img"),d=b.attr("src");b.length&&(a=c("<img />").attr({width:b.attr("width"),height:b.attr("height")}).data("parent",a).one("load.jackbox",xd).insertAfter(b),b.remove(),a.attr("src",d))}function xd(){var a=c(this),b=a.data("parent"),d=parseInt(b.css("width"),10)||b.width(),e= parseInt(b.css("height"),10)||b.height(),b=c("<canvas />").addClass("jackbox-canvas-blur").attr({width:d,height:e}).insertBefore(b),e=Date.now(),d=e+1,e=e+2;a.attr("id",d);b.attr("id",e);StackBlurImage(d,e,29)}function yd(){var a=c(this);a.parent().data({tip:a,tipWidth:a.width()-27,tipHeight:a.height()+17}).on("mouseenter.jackbox",zd).on("mouseleave.jackbox",Ad)}function zd(){var a=c(this),b=a.offset(),d=a.data();d.tipX=b.left;d.tipY=b.top;d.tip.css({opacity:1,visibility:"visible"});a.on("mousemove.jackbox", Ic)}function Ad(){var a=c(this).off("mousemove.jackbox");ma?a.data("tip").css("opacity",0):a.data("tip").css({opacity:0,visibility:"hidden"})}function Bd(a){a.stopImmediatePropagation()}function vc(a){c(a.target).is("a")||(a.stopPropagation(),a.preventDefault())}var u={useThumbs:!0,deepLinking:!0,autoPlayVideo:!1,flashVideoFirst:!1,defaultVideoWidth:960,defaultVideoHeight:540,thumbnailWidth:75,thumbnailHeight:50,useThumbTooltips:!0,preloadGraphics:!0,showInfoByDefault:!1,thumbsStartHidden:!1,fullscreenScalesContent:!0, defaultShareImage:"jackbox/img/default_share.jpg"},na=10,ya=2,Hc="jackbox",Cd=Hc+"/php/graphics.php",ld="jackbox/modules/jackbox_swf.html",jd="jackbox/modules/jackbox_video.html",kd="jackbox/modules/jackbox_audio.html",id="http://player.vimeo.com/video{url}?title=0&byline=0&portrait=0&autoplay={autoplay}&color=FFFFFF&wmode=transparent",hd="http://www.youtube.com/embed/{url}?autoplay={autoplay}&autohide=1&hd=1&iv_load_policy=3&showinfo=0&showsearch=0&wmode=transparent",qb='<div class="jackbox-top clearfix"><div class="jackbox-social"></div><div class="jackbox-top-icons"><span class="jackbox-fullscreen"><span class="jackbox-button jackbox-fs"></span><span class="jackbox-button jackbox-ns"></span></span><span class="jackbox-button jackbox-button-margin jackbox-close"></span></div><div />', rb='<div class="jackbox-bottom clearfix"><div class="jackbox-controls"><span class="jackbox-button jackbox-arrow-left"></span><span class="jackbox-button jackbox-arrow-right"></span></div><div class="jackbox-title-text"><span class="jb-current"></span><span class="jb-divider">/</span><span class="jb-total"></span><span class="jackbox-title-txt"></span></div><div class="jackbox-bottom-icons"><span class="jackbox-button jackbox-info"></span><span class="jackbox-button-margin jackbox-button-thumbs"><span class="jackbox-button jackbox-hide-thumbs"></span><span class="jackbox-button jackbox-show-thumbs"></span></span></div></div>', jc,w,pa,sc,tc,Kb,Ab,jb,sb,Na,Lb,Jc,Ka,zb,Kc,ia,qc,Cb,Mb,L,m,Nb,W,v,F,Y,O,X,la,J,Fa,Ua,ba,ha,V,ca,P,ja,oa,Ob,Eb,wb,Ba,Aa,ga,t,ua,db,ta,Lc,Oa,Mc,va,Ca,q,aa,wa,sa,N,$a,ra,cb,Nc,s,Za,kb,Pa,n,x,e,Ga,r,l,h,k,A,I,Oc,D,g,ea,C,ma,xa,Pb,uc,Ha,p,ac,j,tb,S,lb,Ia,Pc,i,T,La,B,K,gb,Hb,R,oc,ab,Z,H,Q,pc,pb,bb,Ja,da,E,sd,Ib,Ya,M,Qa,hb,U,ib,rc,rd,Qc,za,Qb,Jb,wc,Da,bc,G,yc,Rc,Sc,Bb,Ec,Fc,f=1,y=-1,Va=0,hc=!0,fc=!0,Tc={init:function(a,b){!Qc&&"undefined"!==typeof Jacked&&(b&&c.extend(u,b),bb=u.useThumbs,M=u.deepLinking, Oa=u.useThumbTooltips,wc=u.autoPlayVideo,Da=u.thumbnailWidth,Pc=u.fullscreenScalesContent,G=u.thumbnailHeight,yc=u.flashVideoFirst,Sc=u.showInfoByDefault,Bb=u.thumbsStartHidden,Rc=u.defaultShareImage,Ec=u.defaultVideoWidth,Fc=u.defaultVideoHeight,l=document,Qc=!0,Z=Da+ya,lb=-1!==l.URL.search("file:///"),Jacked.setEngines({ios:!0,safari:!0,opera:!0,firefox:!0}),u.preloadGraphics&&!lb&&c.getJSON(Cd+"?path=../img/graphics/",vd),tb=a,u=null,ma=Jacked.getIE(),s=Jacked.getMobile(),ab=Jacked.getBrowser(), Oc="ie"===ab,"undefined"!==typeof c.address&&M?Oc?(ob(),c.address.update()):c.address.init(ob):(M=!1,ob()),"undefined"!==typeof StackBlurImage&&(!lb&&!ma)&&c(".jackbox-hover-blur").each(wd),c(".jackbox-tooltip").each(yd))},frameReady:function(){Q&&Ma()},newItem:function(a,b){var d=D.length,c=-1,e,f;if(b&&"object"===typeof b){var g,i,k;for(g in b)"trigger"!==g&&(i="data-"+g,k=b[g],a.attr(i,k),"group"===g&&(f=k))}else b=null;f||(f=a.attr("data-group"));if(f){for(f=f.split(" ").join("").toLowerCase();d--;)if(D[d]=== f){c=d;break}if(-1<c){f=C[c];-1!==f.indexOf(a)&&(a.trigger("click"),e=!0);if(e)return;d=f.length;f[d]=a}else c=D.length,d=C.length,D[c]=f,Va++,C[d]=[a],d=0;dc(a);a.data({id:d,cat:c});b&&b.trigger&&a.trigger("click")}}},qa,mb={type:"text/html",frameborder:0,mozallowfullscreen:"mozallowfullscreen",webkitallowfullscreen:"webkitallowfullscreen",allowfullscreen:"allowfullscreen"};qa=function(a,b,d){mb.width=k;mb.height=g;mb.scrolling=!d?"no":"auto";i=c("<iframe />").attr(mb).addClass("jackbox-content").prependTo(ca); if(!b)i.one("load.jackbox",Ma);i.attr("src",a)};var Ma,Rb={};Ma=function(a){a&&a.stopPropagation();La&&(S=this.width||i.width(),T=this.height||i.height(),Gc());Rb.width=k;Rb.height=g;i.css(Rb);Sb(!0);Lb&&Lb();A.on("resize.jackbox",Wa)};var Sb,ka={},Ea={},Ra={};Sb=function(a){if(a){260>k&&(xa+=260-k);a=Math.max(k,260);if(a===Ba&&g===Ob){Tb();return}ka.callback=Tb;ka.duration=Ba?50<Math.abs(a-Ba)||50<Math.abs(g-Ob)?600:300:600}else a=k,Ra.width=a,ka.duration=300,delete ka.callback,v&&Jacked.tween(v[0], Ra,ka),w&&Jacked.tween(w[0],Ra,ka),Ra.height=g,Jacked.stopTween(i[0],!0),Jacked.tween(i[0],Ra,ka);Ea.marginLeft=-((xa>>1)+0.5|0);Ea.marginTop=-((Pb>>1)+0.5|0);Ea.height=g;Ea.width=a;Ba||(Ea.opacity=1);Jacked.tween(j[0],Ea,ka);Ba=a;Ob=g};var Tb,Sa={},Uc={opacity:1,visibility:"visible"};Tb=function(){Vc();P.removeClass("jackbox-spin-preloader");var a=Math.max(k,260);Sa.duration=600;La&&!ma?Jacked.fadeIn(i[0],Sa):(i.show(),("audio"===R||"local"===R)&&i[0].contentWindow.cjInit());Sa.duration=300;ma?(v&& v.css("width",a).show(),w&&w.css("width",a).show()):(v&&(v.css("width",a),Jacked.fadeIn(v[0],Sa)),w&&(w.css("width",a),Jacked.fadeIn(w[0],Sa)));r&&db?(r.show(),F.html(db).show(),Y=-F.outerHeight(),ia.css("height",-Y<g?-Y:g),Sc?(Ca=!0,r.addClass("jb-info-inactive"),F.css("margin-top",0)):(Ca=!1,F.css("margin-top",Y))):r&&(r.hide(),F.hide());Ja=!1;!ib&&N&&(ba.css(Uc),la.css(Uc));if(!Jb&&bb&&N){var a=C[y],b=[],d=I,e,f,h,j;for(Jb=!0;d--;)h=a[d],h.attr("data-thumbnail")?b[d]=!1:(e=h.children("img"),e.length? (h.attr("data-thumbnail",e.attr("src")),b[d]=e):("image"===h.data("type")?h.attr("data-thumbnail",h.attr("href")||h.attr("data-href")):h.attr("data-thumbnail","jackbox/img/thumbs/default.jpg"),b[d]=!1));p=[];U||(d=l.createDocumentFragment(),h=G>>1,U=c("<div />").addClass("jackbox-thumb-holder").css("height",G).appendTo(n),m=c("<div />").addClass("jackbox-thumb-panel").css("height",G),W=c("<div />").addClass("jackbox-thumb-right"),V=c("<div />").addClass("jackbox-thumb-left"),d.appendChild(m[0]),d.appendChild(W[0]), d.appendChild(V[0]),m[0].cjThumbs=!0,U[0].appendChild(d),L=c("<div />").addClass("jackbox-thumb-strip").appendTo(m),V.css("top",h),W.css("top",h));h=l.createDocumentFragment();for(d=0;d<I;d++){f=p[d]=c("<div />").data("id",d).addClass("jackbox-thumb").css({width:Da,height:G,left:Z*d}).on("click.jackbox",Cc);if(Oa&&(e=Ya[d].attr("data-thumbTooltip")||Ya[d].attr("data-title")))f.data("theTitle",e).on("mouseenter.jackbox",Wc).on("mouseleave.jackbox",zc);h.appendChild(f[0]);e=c("<img />").addClass("jb-thumb").one("load.jackbox", od).appendTo(f);f.data("theThumb",e);b[d]?(f=b[d].attr("width")||b[d].width(),j=b[d].attr("height")||b[d].height()):(f=Da,j=G);f>Da&&j>G&&(j=f<j?j/f:f/j,f=Da*j,j*=G,f!==(f|0)&&(f=f+1|0),j!==(j|0)&&(j=j+1|0));e.attr({width:f,height:j,src:a[d].attr("data-thumbnail")})}L[0].appendChild(h);Kc=p.length;Nb=Z*d;E=!0;q=0;U.on("click.jackbox",vc).show();Ub();t&&(Bb?(X.hide(),O.show(),U.css("bottom",ga)):(O.hide(),X.show(),U.css("bottom",0)),t.on("click.jackbox",Xc))}if(!ib){ib=!0;if(pa)J.on("click.jackbox", pd);if(ua)ua.one("click.jackbox",nc);if(r)r.on("click.jackbox",Yc);if(N){if(sa)sa.on("click.jackbox",xb);if(ra)ra.on("click.jackbox",yb);if(Oa&&m)m.on("mouseenter.jackbox",nd)}}s&&(i[0].removeEventListener("touchstart",z,!1),i[0].removeEventListener("touchmove",z,!1),i[0].removeEventListener("touchend",z,!1),kc());if(N){if(E)for(a=p.length;a--;)p[a].on("click.jackbox",Cc);ba.on("click.jackbox",yb);la.on("click.jackbox",xb);s&&wb&&i.cjSwipe("touchSwipe",ud)}};var Vc,nb={type:"text/html",frameborder:0, mozallowfullscreen:"mozallowfullscreen",webkitallowfullscreen:"webkitallowfullscreen",allowfullscreen:"allowfullscreen",scrolling:"no"};Vc=function(){if(!Lc){Lc=!0;Pa=c(".jb-total");r=c(".jackbox-info");va=c(".jb-divider");wa=c(".jb-current");ua=c(".jackbox-close");kb=c(".jackbox-title-text");x=c(".jackbox-title-txt");ta=c(".jackbox-controls");ra=c(".jackbox-arrow-left");Qa=c(".jackbox-social");sa=c(".jackbox-arrow-right");t=c(".jackbox-button-thumbs");O=c(".jackbox-show-thumbs");X=c(".jackbox-hide-thumbs"); x.length||(x=null);kb.length||(kb=null);ra.length||(ra=null);va.length||(va=null);sa.length||(sa=null);ta.length||(ta=null);ua.length||(ua=null);Qa.length||(Qa=null);if(!wa.length||!Pa.length)wa=null;pa?(c(".jackbox-ns").hide(),J.length||(J=pa=null)):J&&J.hide();bb?t.length&&O.length&&X.length?O.hide():t=O=X=null:(t.hide(),t=O=X=null);r.length?(ia=c("<div />").addClass("jackbox-info-text").appendTo(ca).css("visibility","hidden"),F=c("<div />").addClass("jackbox-description-text").appendTo(ia)):r= null;Oa&&(Aa=c("<span />").addClass("jackbox-thumb-tip").css("bottom",G),Kb=c("<span />").addClass("jackbox-thumb-tip-text").text("render me").appendTo(Aa),Aa.appendTo(n),Jc=(parseInt(Aa.css("padding-left"),10)<<1)-(ya<<1))}N||(ta&&ta.hide(),t&&t.hide());if(kb){"false"===ha&&(ha=!1);var a=x&&ha,b=a?" -&nbsp;":"";wa&&N?(wa.text(f+1).show(),Pa.html(I+b).show(),va&&va.show()):(Pa&&Pa.hide(),wa&&wa.hide(),va&&va.hide());a&&(x.html(Eb),a=x.children("a"),a.length&&(a.on("click.jackbox",Bd),x.data("links", a)))}if(Qa&&!lb){var d,a=l.URL.split("#")[0],b=a.length-1;-1!==a.search("/")&&("/"!==a.charAt(b)?(M?d=a+"#/"+ea+"/"+(f+1):d=a,a=a.substring(0,a.lastIndexOf("/"))):(a=a.substring(0,b),M?d=a+"/#/"+ea+"/"+(f+1):d=a));La?b=e.attr("href")||e.attr("data-href"):(b=e.children("img"),b=b.length?b.attr("src"):Rc);-1===b.search("http")&&(b="/"!==b.charAt(0)?a+"/"+b:a+b);nb.width=200;nb.height=21;nb.src="jackbox/modules/jackbox_social.php?url="+encodeURIComponent(d)+"&poster="+b+"&title="+(ha?escape(ha.replace(/(<([^>]+)>)/ig, "")):escape(l.title));hb=c("<iframe />").attr(nb).appendTo(Qa)}};var Yc,Vb={},Wb={duration:300};Yc=function(a){a&&a.stopPropagation();Ca?(Vb.marginTop=Y,Wb.callback=md,r.removeClass("jb-info-inactive")):(r.addClass("jb-info-inactive"),ia.css("visibility","visible"),Vb.marginTop=0,delete Wb.callback);Jacked.tween(F[0],Vb,Wb);Ca=!Ca};var Wc,Xb={opacity:1,visibility:"visible"};Wc=function(){s&&(clearTimeout(Nc),Nc=setTimeout(zc,2E3));var a=c(this),b,d,e;Kb.text(a.data("theTitle"));b=parseInt(Kb.css("width"), 10);e=m.data("offLeft");a=a.offset().left;d=e+m.width()-b-Jc;Xb.width=b;Xb.left=a<e?e:a>d?d:a;Aa.css(Xb)};var Xc,Zc={},Dd={duration:300};Xc=function(a){a.stopPropagation();0===ga?(ga=sb,t&&(X.hide(),O.show())):(ga=0,t&&(O.hide(),X.show()));Zc.bottom=ga;Jacked.tween(U[0],Zc,Dd);569>B||(fa("true"),Sb())};var Ub,Yb={};Ub=function(a){var b=B-160;Nb<b?(ja=Kc,Qb=!1):(ja=b/Z|0,Qb=!0);jb=Z*ja-ya;Mb=ja-1;Yb.marginLeft=-(jb>>1)-ya;Yb.width=jb;m.css(Yb);L.css("width",Nb);Db(a)};var Db,$c={},Ed={duration:300}; Db=function(a,b){if(a)q=f,0!==f&&f+ja>I&&(q=I-ja),Jacked.stopTween(L[0]),L.css("left",q*-Z);else{if(0===f)q=0;else if(f>q+Mb)for(;f>q+Mb;)q++;b?($c.left=q*-Z,Jacked.tween(L[0],$c,Ed)):(Jacked.stopTween(L[0]),L.css("left",q*-Z))}eb(a,!1)};var eb,ad={},Fd={duration:300};eb=function(a,b){V.off(".jackbox");W.off(".jackbox");if(Qb)if(s&&m.cjSwipe("unbindSwipe"),q<I-ja?(W.on("click.jackbox",Ac).show(),s&&m.cjSwipe("touchSwipeLeft",Ac,!0)):W.hide(),0<q?(V.on("click.jackbox",Bc).show(),s&&m.cjSwipe("touchSwipeRight", Bc,!0)):V.hide(),b)ad.left=q*-Z,Jacked.tween(L[0],ad,Fd);else{if(a||!Ib){var c=m.offset().left;V.css("left",c);W.css("left",c+jb);Ib=!0}}else V.hide(),W.hide()};var fa,Zb={opacity:1},Ta={};fa=function(a){B=A.width();K=Math.max(A.height(),226);var b=568<B&&0===ga?Ab:0;Mc="audio"!==R&&"inline"!==R?!Na?cb:cb||Pc:!1;if(gb<B&&Hb+b<K&&!Mc)k=S,g=T;else{k=B/gb;g=K/Hb;var c=k>g?g:k;k=S*c;g=T*c;B>K?g+Za+b>K&&(g=K-Ka-na-b,k=S*(g/T)):k>g?k+gb>B&&(k=B-na,g=T*(k/S)):g+Za+b>K&&(g=K-Ka-na-b,k=S*(g/T));k!==(k|0)&& (k=k+1|0);g!==(g|0)&&(g=g+1|0)}xa=k+zb;Pb=g+Ka+b;"true"!==a&&(Jacked.stopTween(j[0],!1,!0),i&&Jacked.stopTween(i[0],!0,!0),260>k&&(xa+=260-k),a=Math.max(260,k),Zb.width=a,Zb.height=g,Ta.marginLeft=-(0.5*xa+0.5|0),Ta.marginTop=-(0.5*Pb+0.5|0),Ta.width=a,Ta.height=g,j.css(Ta),i.css(Zb),w&&(Jacked.stopTween(w[0]),w.css("width",a)),v&&(Jacked.stopTween(v[0]),v.css("width",a)),r&&db&&(Y=-F.outerHeight(),ia.css("height",-Y<g?-Y:g),Ca||(Jacked.stopTween(F[0],!1,!0),F.css("margin-top",Y))),E&&Ub(!0))};var Ic, $b={};Ic=function(a){var b=c(this).data();$b.left=a.pageX-b.tipX-b.tipWidth;$b.top=a.pageY-b.tipY-b.tipHeight;b.tip.css($b)};c.fn.jackBox=function(a,b){if(Tc.hasOwnProperty(a))Tc[a](this,b)};c.jackBox={available:function(a){a&&(bc?M?setTimeout(a,250):a():Ha=a)},itemLoaded:function(a){Lb=a}}})(jQuery);function jackboxFrameReady(){$.fn.jackBox("frameReady")};